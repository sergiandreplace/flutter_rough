workflows:
  my-workflow:
    name: Release version
    environment:
      vars:
        CACHED_JSON: Encrypted(Z0FBQUFBQmVzSmxXcmN2SDRObDRfbDBpR1ZLSFh2M3lsLVhwNncySkFzRlpNVHpHOHpua0tpalJ4QWpTSUJrYnRwTnpzcF9iaVlJUUNuMXBPbEVVWVpPY3AwUHZwd3Z1QnlSWFBReDY4MlpVMVFlTmVpVW5uQTFIczIzZGpxbGU5UGtHLVZDVTBBLWJVX3NrbnVxRExDeFpFeGY3eVMxSDFfREV3b0Q4d1hMOHQ4MUNfTDVnUl93RTNrNEROMlZTNE9SelV6MG1GdFdvLXNGY1EyT0VZTDh3VmdiT1lNNDhRVm5NVXY0TmRhMHNybHhwUmE0bDNGRlQwUHNaOW5HSFB0dmhrY2prdWZQVWdUbGRXdzJlUkd1akltSWdQUkJodWgwdFdBQ0NXazdxX3J2TnNWNnktSTlhM2xsdkUwUEdWNXExVDdzd2FvbDNDYzJDTDd3RmRqd1QwY19LclpncFMzMlZQR0hMRS1zM05kNTN0Umc3eVgtZGJTb2c1RGhfYmRJZ1RtTVhvNEVyRG5oVnd6Wi1XOHlLQWlTelcwN1hHZk8yZkpPWDVjM3A4T050N1FDclZuR3ZDRDRQZmhFWGVMZDR6R0x4VXBTOTdBbzI4TTQybENXcHdkTEE5QjN4VFpFLXU0NkRvLXUydXZYUDVoeGxlV083UHpLek1PRnByZEdfX3QtZWtZVTRZWHI0YWZvdE1WcUtsM2s5NU1TM0lDZmNrQWhTYjFsbmJEQW9KMkdMUmVSSDk5NXppbXpoS2dDQUVKNjgxUjFRUGlYNjZsalZXUmN1WlZORzdFSFRab3gzODBwMmdnUHdmakNGWnB1YU1rNS1TSVVJUndrN201UDE3WHdUQ1BIeW5icnNjMWZwS0JEeXNGalpuSDI1QW52cWJaUUwzRDUzeEdKTEExdnB5OGE3OGU3YXc1MU5VTkhkWnJtbDBiMWw=)
      flutter: stable
    cache:
      cache_paths:
        - ~/.pub-cache
    triggering:
      events:
        - tag
      branch_patterns:
        - pattern: 'test_codemagic'
          include: true
          source: true
    scripts:
      - flutter packages pub get
      - chmod +x ./scripts/cache.sh
      - ./scripts/cache.sh
      - flutter pub publish --dry-run
      - flutter pub publish -f
